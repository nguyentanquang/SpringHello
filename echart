Imports System
Imports System.Diagnostics
Imports System.IO ' Thêm thư viện này

Module Module1

    Sub Main()
        ' Khởi tạo StreamWriter để lưu log vào file
        Dim logFile As New StreamWriter("C:\Users\PC\Documents\Visual Studio 2013\Projects\ConsoleApplication1\ConsoleApplication1\bin\Debug\log.txt", True) ' Mở file log.txt để ghi tiếp

        Dim ie As Object
        ie = CreateObject("InternetExplorer.Application")
        ie.Visible = True ' Hiển thị trình duyệt

        ' Ghi log với thời gian
        logFile.WriteLine(DateTime.Now.ToString("dd/MM/yyyy HH:mm:ss") & " Trình duyệt đã được mở")

        ' Mở một trang web
        ie.Navigate("http://www.example.com")

        ' Ghi log với thời gian
        logFile.WriteLine(DateTime.Now.ToString("dd/MM/yyyy HH:mm:ss") & " Đang mở trang http://www.example.com")

        ' Đợi trình duyệt tải hoàn toàn trang web
        Do While ie.Busy
            System.Threading.Thread.Sleep(100)
        Loop

        ' Thực hiện các tác vụ khác trên trang web ở đây
        ' Ví dụ: 
        ' ie.Document.GetElementById("elementId").InnerText = "Hello, World!"

        ' Ghi log với thời gian
        logFile.WriteLine(DateTime.Now.ToString("dd/MM/yyyy HH:mm:ss") & " Thực hiện các tác vụ khác trên trang web")

        ' Đóng trình duyệt
        ie.Quit()

        ' Ghi log với thời gian và đóng file
        logFile.WriteLine(DateTime.Now.ToString("dd/MM/yyyy HH:mm:ss") & " Trình duyệt đã được đóng")
        logFile.Close()
    End Sub

End Module
