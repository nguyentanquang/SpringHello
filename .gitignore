大変申し訳ございませんが、全体的に現状のコードでは分かりやすく改善するのは難しいと思います。
しかし、どの混乱している点を教えていただければ幸いです。
ご指摘いただきました点につきましては、より適切な解決策を検討させていただきます。
